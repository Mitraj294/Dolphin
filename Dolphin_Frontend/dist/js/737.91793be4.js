"use strict";(self["webpackChunkdolphin"]=self["webpackChunkdolphin"]||[]).push([[737],{4737:(e,t,a)=>{a.r(t),a.d(t,{default:()=>_});var s=a(641),i=a(3751);const l={class:"page"},o={class:"lead-capture-outer"},r={class:"lead-capture-card"},n={class:"org-edit-actions"};function d(e,t,a,d,u,m){const f=(0,s.g2)("FormLabel"),h=(0,s.g2)("FormInput"),c=(0,s.g2)("FormRow"),p=(0,s.g2)("FormDropdown"),_=(0,s.g2)("MainLayout");return(0,s.uX)(),(0,s.Wv)(_,null,{default:(0,s.k6)(()=>[(0,s.Lk)("div",l,[(0,s.Lk)("div",o,[(0,s.Lk)("div",r,[t[30]||(t[30]=(0,s.Lk)("h3",{class:"lead-capture-card-title"},"Edit Lead",-1)),(0,s.Lk)("form",{class:"lead-capture-form",onSubmit:t[13]||(t[13]=(0,i.D$)((...e)=>m.handleUpdateLead&&m.handleUpdateLead(...e),["prevent"]))},[(0,s.bF)(c,null,{default:(0,s.k6)(()=>[(0,s.Lk)("div",null,[(0,s.bF)(f,null,{default:(0,s.k6)(()=>[...t[14]||(t[14]=[(0,s.eW)("First Name",-1)])]),_:1}),(0,s.bF)(h,{modelValue:u.form.first_name,"onUpdate:modelValue":t[0]||(t[0]=e=>u.form.first_name=e),icon:"fas fa-user",placeholder:"Type here"},null,8,["modelValue"])]),(0,s.Lk)("div",null,[(0,s.bF)(f,null,{default:(0,s.k6)(()=>[...t[15]||(t[15]=[(0,s.eW)("Last Name",-1)])]),_:1}),(0,s.bF)(h,{modelValue:u.form.last_name,"onUpdate:modelValue":t[1]||(t[1]=e=>u.form.last_name=e),icon:"fas fa-user",placeholder:"Type here"},null,8,["modelValue"])]),(0,s.Lk)("div",null,[(0,s.bF)(f,null,{default:(0,s.k6)(()=>[...t[16]||(t[16]=[(0,s.eW)("Email",-1)])]),_:1}),(0,s.bF)(h,{modelValue:u.form.email,"onUpdate:modelValue":t[2]||(t[2]=e=>u.form.email=e),icon:"fas fa-envelope",type:"email",placeholder:"abc@gmail.com"},null,8,["modelValue"])])]),_:1}),(0,s.bF)(c,null,{default:(0,s.k6)(()=>[(0,s.Lk)("div",null,[(0,s.bF)(f,null,{default:(0,s.k6)(()=>[...t[17]||(t[17]=[(0,s.eW)("Phone",-1)])]),_:1}),(0,s.bF)(h,{modelValue:u.form.phone,"onUpdate:modelValue":t[3]||(t[3]=e=>u.form.phone=e),icon:"fas fa-phone",placeholder:"Type here"},null,8,["modelValue"])]),(0,s.Lk)("div",null,[(0,s.bF)(f,null,{default:(0,s.k6)(()=>[...t[18]||(t[18]=[(0,s.eW)("How did you find us?",-1)])]),_:1}),(0,s.bF)(p,{modelValue:u.form.find_us,"onUpdate:modelValue":t[4]||(t[4]=e=>u.form.find_us=e),icon:"fas fa-search",options:[{value:null,text:"Select",disabled:!0},{value:"Google",text:"Google"},{value:"Friend",text:"Friend"},{value:"Colleague",text:"Colleague"},{value:"Other",text:"Other"}]},null,8,["modelValue"])]),t[19]||(t[19]=(0,s.Lk)("div",null,null,-1))]),_:1}),(0,s.bF)(c,null,{default:(0,s.k6)(()=>[(0,s.Lk)("div",null,[(0,s.bF)(f,null,{default:(0,s.k6)(()=>[...t[20]||(t[20]=[(0,s.eW)("Organization Name",-1)])]),_:1}),(0,s.bF)(h,{modelValue:u.form.org_name,"onUpdate:modelValue":t[5]||(t[5]=e=>u.form.org_name=e),icon:"fas fa-cog",placeholder:"Flexi-Finders"},null,8,["modelValue"])]),(0,s.Lk)("div",null,[(0,s.bF)(f,null,{default:(0,s.k6)(()=>[...t[21]||(t[21]=[(0,s.eW)("Organization Size",-1)])]),_:1}),(0,s.bF)(p,{modelValue:u.form.org_size,"onUpdate:modelValue":t[6]||(t[6]=e=>u.form.org_size=e),icon:"fas fa-users",options:[{value:null,text:"Select",disabled:!0},{value:"Large",text:"250+ Employees (Large)"},{value:"Medium",text:"100-249 Employees (Medium)"},{value:"Small",text:"1-99 Employees (Small)"}]},null,8,["modelValue"])]),t[22]||(t[22]=(0,s.Lk)("div",null,null,-1))]),_:1}),(0,s.bF)(c,null,{default:(0,s.k6)(()=>[(0,s.Lk)("div",null,[(0,s.bF)(f,null,{default:(0,s.k6)(()=>[...t[23]||(t[23]=[(0,s.eW)("Address ",-1)])]),_:1}),(0,s.bF)(h,{modelValue:u.form.address,"onUpdate:modelValue":t[7]||(t[7]=e=>u.form.address=e),icon:"fas fa-map-marker-alt",placeholder:"Enter address"},null,8,["modelValue"])]),(0,s.Lk)("div",null,[(0,s.bF)(f,null,{default:(0,s.k6)(()=>[...t[24]||(t[24]=[(0,s.eW)("Country",-1)])]),_:1}),(0,s.bF)(p,{modelValue:u.form.country_id,"onUpdate:modelValue":t[8]||(t[8]=e=>u.form.country_id=e),icon:"fas fa-globe",onChange:m.onCountryChange,options:[{value:null,text:"Select",disabled:!0},...u.countries.map(e=>({value:e.id,text:e.name}))]},null,8,["modelValue","onChange","options"])]),(0,s.Lk)("div",null,[(0,s.bF)(f,null,{default:(0,s.k6)(()=>[...t[25]||(t[25]=[(0,s.eW)("State",-1)])]),_:1}),(0,s.bF)(p,{modelValue:u.form.state_id,"onUpdate:modelValue":t[9]||(t[9]=e=>u.form.state_id=e),icon:"fas fa-map-marker-alt",onChange:m.onStateChange,options:[{value:null,text:"Select",disabled:!0},...u.states.map(e=>({value:e.id,text:e.name}))]},null,8,["modelValue","onChange","options"])])]),_:1}),(0,s.bF)(c,null,{default:(0,s.k6)(()=>[(0,s.Lk)("div",null,[(0,s.bF)(f,null,{default:(0,s.k6)(()=>[...t[26]||(t[26]=[(0,s.eW)("City",-1)])]),_:1}),(0,s.bF)(p,{modelValue:u.form.city_id,"onUpdate:modelValue":t[10]||(t[10]=e=>u.form.city_id=e),icon:"fas fa-map-marker-alt",options:[{value:null,text:"Select",disabled:!0},...u.cities.map(e=>({value:e.id,text:e.name}))]},null,8,["modelValue","options"])]),(0,s.Lk)("div",null,[(0,s.bF)(f,null,{default:(0,s.k6)(()=>[...t[27]||(t[27]=[(0,s.eW)("Zip Code",-1)])]),_:1}),(0,s.bF)(h,{modelValue:u.form.zip,"onUpdate:modelValue":t[11]||(t[11]=e=>u.form.zip=e),icon:"fas fa-map-marker-alt",placeholder:"Enter PIN code"},null,8,["modelValue"])]),t[28]||(t[28]=(0,s.Lk)("div",null,null,-1))]),_:1}),(0,s.Lk)("div",n,[(0,s.Lk)("button",{type:"button",class:"org-edit-cancel",onClick:t[12]||(t[12]=t=>e.$router.push("/leads"))}," Cancel "),t[29]||(t[29]=(0,s.Lk)("button",{type:"submit",class:"org-edit-update"}," Update Lead ",-1))])],32)])])])]),_:1})}var u=a(2724),m=a(8608),f=a(4335);const h={name:"EditLead",components:{MainLayout:u.A,FormRow:m.fh,FormLabel:m.lR,FormInput:m.ZQ,FormDropdown:m.ad,FormBox:m.CQ},data(){return{form:{first_name:"",last_name:"",email:"",phone:"",find_us:"",org_name:"",org_size:"",address:"",country_id:null,state_id:null,city_id:null,zip:""},countries:[],states:[],cities:[],loading:!1,successMessage:"",errorMessage:""}},async created(){await this.fetchCountries();const e=this.$route.query,t=this.$route.params.id||e.id;if(t)try{const e="http://127.0.0.1:8000",s=a(3193)["default"],i=s.get("authToken"),l=await f.A.get(`${e}/api/leads/${t}`,{headers:{Authorization:`Bearer ${i}`}}),o=l.data||null,r=o&&o.lead?o.lead:o;if(r)return this.form.first_name=r.first_name||"",this.form.last_name=r.last_name||"",this.form.email=r.email||"",this.form.phone=r.phone||"",this.form.find_us=r.find_us||"",this.form.org_name=r.org_name||"",this.form.org_size=r.org_size||"",this.form.address=r.address||"",this.form.country_id=r.country_id||null,this.form.state_id=r.state_id||null,this.form.city_id=r.city_id||null,this.form.zip=r.zip||"",this.form.country_id&&await this.fetchStates(),this.form.state_id&&await this.fetchCities(),void this.$nextTick(()=>{const e=`${this.form.first_name||""} ${this.form.last_name||""}`.trim();this.$root&&this.$root.$emit&&this.$root.$emit("page-title-override",e?`Edit Lead : ${e}`:"Edit Lead")})}catch(i){}const s=e.lead?"string"===typeof e.lead?JSON.parse(e.lead):e.lead:{};this.form.first_name=e.first_name||e.contact?.split(" ")[0]||s.first_name||"",this.form.last_name=e.last_name||e.contact?.split(" ")[1]||s.last_name||"",this.form.email=e.email||s.email||"",this.form.phone=e.phone||s.phone||"",this.form.find_us=e.source||e.find_us||s.find_us||"",this.form.org_name=e.organization||e.org_name||s.org_name||"",this.form.org_size=e.size||e.org_size||s.org_size||"",this.form.address=e.address||e.address_line||s.address||s.address_line||"",this.form.country_id=e.country_id||s.country_id||null,this.form.state_id=e.state_id||s.state_id||null,this.form.city_id=e.city_id||s.city_id||null,this.form.zip=e.zip||s.zip||"",this.form.country_id&&await this.fetchStates(),this.form.state_id&&await this.fetchCities()},methods:{async fetchCountries(){const e="http://127.0.0.1:8000",t=await f.A.get(`${e}/api/countries`);this.countries=t.data},async fetchStates(){if(!this.form.country_id)return void(this.states=[]);const e="http://127.0.0.1:8000",t=await f.A.get(`${e}/api/states?country_id=${this.form.country_id}`);this.states=t.data},async fetchCities(){if(!this.form.state_id)return void(this.cities=[]);const e="http://127.0.0.1:8000",t=await f.A.get(`${e}/api/cities?state_id=${this.form.state_id}`);this.cities=t.data},onCountryChange(){let e=this.form.country_id;if(null!==e&&""!==e&&"number"!==typeof e){const t=Number(e);isNaN(t)||(this.form.country_id=t,e=t)}e&&"number"===typeof e?(this.form.state_id=null,this.form.city_id=null,this.states=[],this.cities=[],this.fetchStates()):(this.form.state_id=null,this.form.city_id=null,this.states=[],this.cities=[])},onStateChange(){let e=this.form.state_id;if(null!==e&&""!==e&&"number"!==typeof e){const t=Number(e);isNaN(t)||(this.form.state_id=t,e=t)}e&&"number"===typeof e?(this.form.city_id=null,this.cities=[],this.fetchCities()):(this.form.city_id=null,this.cities=[])},async handleUpdateLead(){this.loading=!0,this.successMessage="",this.errorMessage="";try{const e=a(3193)["default"],t=e.get("authToken");if(!t)return this.errorMessage="Authentication token not found. Please log in.",this.loading=!1,void this.$toast.add({severity:"error",summary:"Authentication Error",detail:this.errorMessage,life:5e3});const s="http://127.0.0.1:8000",i=this.$route.params.id||this.$route.query.id;if(!i)return this.errorMessage="Lead ID not found in route query.",this.loading=!1,void this.$toast.add({severity:"error",summary:"Error",detail:this.errorMessage,life:5e3});const l={...this.form},o=await f.A.patch(`${s}/api/leads/${i}`,l,{headers:{Authorization:`Bearer ${t}`}});this.successMessage=o.data.message||"Lead updated successfully!",this.$toast.add({severity:"success",summary:"Success",detail:this.successMessage,life:3e3}),this.$router.push("/leads")}catch(e){if(console.error("Error updating lead:",e),e.response&&e.response.data){if(this.errorMessage=e.response.data.message||"Failed to update lead.",e.response.data.errors)for(const t in e.response.data.errors)this.errorMessage+=` ${e.response.data.errors[t][0]}`}else this.errorMessage="An unexpected error occurred.";this.$toast.add({severity:"error",summary:"Error",detail:this.errorMessage,life:5e3})}finally{this.loading=!1}}}};var c=a(6262);const p=(0,c.A)(h,[["render",d],["__scopeId","data-v-c144b564"]]),_=p}}]);
//# sourceMappingURL=737.91793be4.js.map