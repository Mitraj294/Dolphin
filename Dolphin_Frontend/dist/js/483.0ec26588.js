"use strict";(self["webpackChunkdolphin"]=self["webpackChunkdolphin"]||[]).push([[483],{7483:(e,t,a)=>{a.r(t),a.d(t,{default:()=>U});var l=a(641),s=a(3751),o=a(33),i=a(9586);const r={class:"page"},n={class:"table-outer"},d={class:"table-card"},m={class:"table-search-bar"},c={class:"table-container"},u={class:"table"},b=["onClick"],h={key:0},p={class:"profile-card member-profile-card"},g={class:"profile-header"},M={class:"profile-info-table"},k={class:"profile-info-row"},f={class:"profile-value"},L={class:"profile-info-row"},y={class:"profile-value"},v={class:"profile-info-row"},w={class:"profile-value"},P={class:"profile-info-row"},_={class:"profile-value"},E={class:"profile-actions"};function F(e,t,a,F,S,A){const C=(0,l.g2)("TableHeader"),V=(0,l.g2)("Pagination"),z=(0,l.g2)("FormLabel"),W=(0,l.g2)("FormInput"),T=(0,l.g2)("FormRow"),D=(0,l.g2)("CommonModal"),K=(0,l.g2)("MainLayout");return(0,l.uX)(),(0,l.Wv)(K,null,{default:(0,l.k6)(()=>[(0,l.Lk)("div",r,[(0,l.Lk)("div",n,[S.showMemberModal?((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[(0,l.Lk)("div",p,[(0,l.Lk)("div",g,[t[15]||(t[15]=(0,l.Lk)("div",{class:"profile-title"},[(0,l.Lk)("i",{class:"fas fa-user-circle profile-avatar"}),(0,l.Lk)("span",null,"Member")],-1)),(0,l.Lk)("div",null,[(0,l.Lk)("button",{class:"btn btn-primary",onClick:t[3]||(t[3]=(...e)=>A.openEditModal&&A.openEditModal(...e))},[...t[14]||(t[14]=[(0,l.Lk)("i",{class:"fas fa-pen-to-square"},null,-1),(0,l.eW)(" Edit ",-1)])])])]),(0,l.Lk)("div",M,[(0,l.Lk)("div",k,[t[16]||(t[16]=(0,l.Lk)("div",{class:"profile-label"},"Name",-1)),(0,l.Lk)("div",f,(0,o.v_)(S.selectedMemberEdit.first_name)+" "+(0,o.v_)(S.selectedMemberEdit.last_name),1)]),(0,l.Lk)("div",L,[t[17]||(t[17]=(0,l.Lk)("div",{class:"profile-label"},"Email",-1)),(0,l.Lk)("div",y,(0,o.v_)(S.selectedMemberEdit.email),1)]),(0,l.Lk)("div",v,[t[18]||(t[18]=(0,l.Lk)("div",{class:"profile-label"},"Role",-1)),(0,l.Lk)("div",w,(0,o.v_)(S.selectedMemberEdit.member_role),1)]),(0,l.Lk)("div",P,[t[19]||(t[19]=(0,l.Lk)("div",{class:"profile-label"},"Phone",-1)),(0,l.Lk)("div",_,(0,o.v_)(S.selectedMemberEdit.phone),1)])]),(0,l.Lk)("div",E,[(0,l.Lk)("button",{class:"btn btn-danger",onClick:t[4]||(t[4]=e=>A.deleteMember(S.selectedMemberEdit))},[...t[20]||(t[20]=[(0,l.Lk)("i",{class:"fas fa-trash"},null,-1),(0,l.eW)(" Delete Member ",-1)])]),(0,l.Lk)("button",{class:"btn btn-secondary",onClick:t[5]||(t[5]=(...e)=>A.closeMemberModal&&A.closeMemberModal(...e)),style:{"margin-left":"12px"}}," Cancel ")])]),(0,l.bF)(D,{visible:S.showEditModal,onClose:A.closeEditModal,onSubmit:A.onEditSave},{title:(0,l.k6)(()=>[...t[21]||(t[21]=[(0,l.eW)("Edit Profile",-1)])]),actions:(0,l.k6)(()=>[t[27]||(t[27]=(0,l.Lk)("button",{type:"submit",class:"btn btn-primary"},[(0,l.Lk)("i",{class:"fas fa-save"}),(0,l.eW)(" Save ")],-1)),(0,l.Lk)("button",{type:"button",class:"btn btn-secondary",onClick:t[11]||(t[11]=(...e)=>A.closeEditModal&&A.closeEditModal(...e)),style:{"margin-left":"12px"}}," Cancel ")]),default:(0,l.k6)(()=>[(0,l.bF)(T,null,{default:(0,l.k6)(()=>[(0,l.bF)(z,null,{default:(0,l.k6)(()=>[...t[22]||(t[22]=[(0,l.eW)("First Name",-1)])]),_:1}),(0,l.bF)(W,{modelValue:S.editMember.first_name,"onUpdate:modelValue":t[6]||(t[6]=e=>S.editMember.first_name=e),type:"text",required:"",placeholder:"First Name"},null,8,["modelValue"]),(0,l.bF)(z,null,{default:(0,l.k6)(()=>[...t[23]||(t[23]=[(0,l.eW)("Last Name",-1)])]),_:1}),(0,l.bF)(W,{modelValue:S.editMember.last_name,"onUpdate:modelValue":t[7]||(t[7]=e=>S.editMember.last_name=e),type:"text",required:"",placeholder:"Last Name"},null,8,["modelValue"])]),_:1}),(0,l.bF)(T,null,{default:(0,l.k6)(()=>[(0,l.bF)(z,null,{default:(0,l.k6)(()=>[...t[24]||(t[24]=[(0,l.eW)("Email",-1)])]),_:1}),(0,l.bF)(W,{modelValue:S.editMember.email,"onUpdate:modelValue":t[8]||(t[8]=e=>S.editMember.email=e),type:"email",required:"",placeholder:""},null,8,["modelValue"])]),_:1}),(0,l.bF)(T,null,{default:(0,l.k6)(()=>[(0,l.bF)(z,null,{default:(0,l.k6)(()=>[...t[25]||(t[25]=[(0,l.eW)("Phone",-1)])]),_:1}),(0,l.bF)(W,{modelValue:S.editMember.phone,"onUpdate:modelValue":t[9]||(t[9]=e=>S.editMember.phone=e),type:"text",placeholder:""},null,8,["modelValue"])]),_:1}),(0,l.bF)(T,null,{default:(0,l.k6)(()=>[(0,l.bF)(z,null,{default:(0,l.k6)(()=>[...t[26]||(t[26]=[(0,l.eW)("Country",-1)])]),_:1}),(0,l.bF)(W,{modelValue:S.editMember.country,"onUpdate:modelValue":t[10]||(t[10]=e=>S.editMember.country=e),type:"text",placeholder:""},null,8,["modelValue"])]),_:1})]),_:1},8,["visible","onClose","onSubmit"])],64)):((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[(0,l.Lk)("div",d,[(0,l.Lk)("div",m,[(0,l.bo)((0,l.Lk)("input",{class:"org-search",placeholder:"Search Member...","onUpdate:modelValue":t[0]||(t[0]=e=>S.searchQuery=e),onInput:t[1]||(t[1]=(...e)=>A.onSearch&&A.onSearch(...e))},null,544),[[s.Jo,S.searchQuery]])]),(0,l.Lk)("div",c,[(0,l.Lk)("table",u,[(0,l.bF)(C,{columns:[{label:"Name",key:"name"},{label:"Email",key:"email"},{label:"Phone Number",key:"phone"},{label:"Role",key:"role"},{label:"Actions",key:"actions"}],onSort:A.sortBy},null,8,["onSort"]),(0,l.Lk)("tbody",null,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(A.paginatedMembers,(e,a)=>((0,l.uX)(),(0,l.CE)("tr",{key:e.id},[(0,l.Lk)("td",null,(0,o.v_)(e.first_name)+" "+(0,o.v_)(e.last_name),1),(0,l.Lk)("td",null,(0,o.v_)(e.email),1),(0,l.Lk)("td",null,(0,o.v_)(e.phone),1),(0,l.Lk)("td",null,(0,o.v_)(e.member_role),1),(0,l.Lk)("td",null,[(0,l.Lk)("button",{class:"btn-view",onClick:t=>A.openMemberModal(e)},[...t[12]||(t[12]=[(0,l.Lk)("img",{src:i,alt:"View",class:"btn-view-icon"},null,-1),(0,l.eW)(" View ",-1)])],8,b)])]))),128)),0===A.paginatedMembers.length?((0,l.uX)(),(0,l.CE)("tr",h,[...t[13]||(t[13]=[(0,l.Lk)("td",{colspan:"5",class:"no-data"}," No members found. ",-1)])])):(0,l.Q3)("",!0)])])])]),(0,l.bF)(V,{pageSize:S.pageSize,pageSizes:[10,25,100],showPageDropdown:S.showPageDropdown,currentPage:S.currentPage,totalPages:A.totalPages,paginationPages:A.paginationPages,onGoToPage:A.goToPage,onSelectPageSize:A.selectPageSize,onTogglePageDropdown:t[2]||(t[2]=e=>S.showPageDropdown=!S.showPageDropdown)},null,8,["pageSize","showPageDropdown","currentPage","totalPages","paginationPages","onGoToPage","onSelectPageSize"])],64))])])]),_:1})}var S=a(2724),A=a(280),C=a(8406),V=a(4335),z=a(3193),W=a(1609),T=a(7420),D=a(2124),K=a(1456);const x={name:"MemberListing",components:{MainLayout:S.A,Pagination:A.A,TableHeader:C.A,CommonModal:W.A,FormRow:T.A,FormLabel:D.A,FormInput:K.A},data(){return{currentPage:1,pageSize:10,searchQuery:"",showPageDropdown:!1,sortKey:"",sortAsc:!0,members:[],filteredMembers:[],showMemberModal:!1,showEditModal:!1,selectedMemberEdit:{id:"",first_name:"",last_name:"",email:"",phone:"",member_role:"",country:""},editMember:{id:"",first_name:"",last_name:"",email:"",phone:"",member_role:"",country:""}}},computed:{totalPages(){return Math.ceil(this.filteredMembers.length/this.pageSize)||1},paginatedMembers(){let e=[...this.filteredMembers];this.sortKey&&e.sort((e,t)=>{let a=e[this.sortKey],l=t[this.sortKey];return a<l?this.sortAsc?-1:1:a>l?this.sortAsc?1:-1:0});const t=(this.currentPage-1)*this.pageSize;return e.slice(t,t+this.pageSize)},paginationPages(){const e=this.totalPages;if(e<=7)return Array.from({length:e},(e,t)=>t+1);{const t=[1];this.currentPage>4&&t.push("...");for(let a=Math.max(2,this.currentPage-1);a<=Math.min(e-1,this.currentPage+1);a++)t.push(a);return this.currentPage<e-3&&t.push("..."),t.push(e),t}}},methods:{openMemberModal(e){this.selectedMemberEdit={...e},this.showMemberModal=!0},openEditModal(){this.editMember={...this.selectedMemberEdit},this.showEditModal=!0},closeEditModal(){this.showEditModal=!1},closeMemberModal(){this.showMemberModal=!1,this.isEditing=!1},async onEditSave(){const e=z["default"].get("authToken"),t={};e&&(t["Authorization"]=`Bearer ${e}`);try{await V.A.put(`http://127.0.0.1:8000/api/members/${this.editMember.id}`,this.editMember,{headers:t});const e=this.members.findIndex(e=>e.id===this.editMember.id);-1!==e&&this.members.splice(e,1,{...this.editMember}),this.selectedMemberEdit={...this.editMember},this.onSearch(),this.showEditModal=!1}catch(a){alert("Failed to update member.")}},async deleteMember(e){if(this.isEditing=!1,!confirm("Are you sure you want to delete this member?"))return;const t=z["default"].get("authToken"),a={};t&&(a["Authorization"]=`Bearer ${t}`);try{await V.A.delete(`http://127.0.0.1:8000/api/members/${e.id}`,{headers:a}),this.members=this.members.filter(t=>t.id!==e.id),this.onSearch(),this.showMemberModal=!1}catch(l){alert("Failed to delete member.")}},onSearch(){const e=this.searchQuery.trim().toLowerCase();this.filteredMembers=e?this.members.filter(t=>`${t.first_name} ${t.last_name}`.toLowerCase().includes(e)||t.email.toLowerCase().includes(e)||(t.phone||"").replace(/\s+/g,"").includes(e.replace(/\s+/g,""))||(t.member_role||"").toLowerCase().includes(e)):this.members,this.currentPage=1},goToPage(e){"..."===e||e<1||e>this.totalPages||(this.currentPage=e)},selectPageSize(e){this.pageSize=e,this.currentPage=1,this.showPageDropdown=!1},sortBy(e){this.sortKey===e?this.sortAsc=!this.sortAsc:(this.sortKey=e,this.sortAsc=!0)}},async mounted(){try{const e=z["default"].get("authToken"),t="http://127.0.0.1:8000",a=await V.A.get(`${t}/api/members`,{headers:{Authorization:`Bearer ${e}`}});this.members=Array.isArray(a.data)?a.data:[],this.filteredMembers=this.members}catch(e){this.members=[],this.filteredMembers=[]}}};var N=a(6262);const $=(0,N.A)(x,[["render",F]]),U=$}}]);
//# sourceMappingURL=483.0ec26588.js.map