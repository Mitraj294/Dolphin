"use strict";(self["webpackChunkdolphin"]=self["webpackChunkdolphin"]||[]).push([[411],{6411:(a,t,e)=>{e.r(t),e.d(t,{default:()=>x});var i=e(641),s=e(33);const r={class:"page"},l={class:"lead-detail-outer"},o={class:"lead-detail-main-card"},n={class:"lead-detail-main-card-header"},d={class:"lead-detail-main-cols"},c={class:"lead-detail-main-cols-group lead-detail-main-cols-group--row"},u={class:"lead-detail-col lead-detail-col-left"},h={class:"lead-detail-list-card lead-detail-list-card--box"},g={class:"lead-detail-list-row"},y={class:"lead-detail-list-row"},p={class:"lead-detail-list-row"},_={class:"lead-detail-list-row"},L={class:"lead-detail-list-row"},D={class:"lead-detail-list-row"},k={class:"lead-detail-col lead-detail-col-right"},m={class:"lead-detail-list-card lead-detail-list-card--box"},z={class:"lead-detail-list-row"},v={class:"lead-detail-list-row"},f={class:"lead-detail-list-row"},$={class:"lead-detail-list-row"},N={class:"lead-detail-list-row"},w={class:"lead-detail-list-row"},C={class:"lead-detail-list-row"},E={class:"lead-detail-list-row"},q={class:"lead-detail-list-row"},A={class:"lead-detail-list-row"};function b(a,t,e,b,U,O){const S=(0,i.g2)("MainLayout");return(0,i.uX)(),(0,i.Wv)(S,null,{default:(0,i.k6)(()=>[(0,i.Lk)("div",r,[(0,i.Lk)("div",l,[(0,i.Lk)("div",o,[(0,i.Lk)("div",n,[(0,i.Lk)("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=(...a)=>O.goToEditLead&&O.goToEditLead(...a))}," Edit Details ")]),(0,i.Lk)("div",d,[(0,i.Lk)("div",c,[(0,i.Lk)("div",u,[t[7]||(t[7]=(0,i.Lk)("h3",{class:"lead-detail-section-title"},"Lead Detail",-1)),(0,i.Lk)("div",h,[(0,i.Lk)("div",g,[t[1]||(t[1]=(0,i.Lk)("span",null,"Main Contact",-1)),(0,i.Lk)("b",null,(0,s.v_)(O.leadData.contact),1)]),(0,i.Lk)("div",y,[t[2]||(t[2]=(0,i.Lk)("span",null,"Admin Email",-1)),(0,i.Lk)("b",null,(0,s.v_)(O.leadData.email),1)]),(0,i.Lk)("div",p,[t[3]||(t[3]=(0,i.Lk)("span",null,"Admin Phone",-1)),(0,i.Lk)("b",null,(0,s.v_)(O.leadData.phone),1)]),(0,i.Lk)("div",_,[t[4]||(t[4]=(0,i.Lk)("span",null,"Sales Person",-1)),(0,i.Lk)("b",null,(0,s.v_)(O.leadData.sales_person??a.organization.sales_person_id??"N/A"),1)]),(0,i.Lk)("div",L,[t[5]||(t[5]=(0,i.Lk)("span",null,"Source",-1)),(0,i.Lk)("b",null,(0,s.v_)(O.leadData.source),1)]),(0,i.Lk)("div",D,[t[6]||(t[6]=(0,i.Lk)("span",null,"Status",-1)),(0,i.Lk)("b",null,(0,s.v_)(O.leadData.status),1)])])]),(0,i.Lk)("div",k,[t[18]||(t[18]=(0,i.Lk)("h3",{class:"lead-detail-section-title"},"Organization Detail",-1)),(0,i.Lk)("div",m,[U.organizationChecked&&U.isOrganizationCreated?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[(0,i.Lk)("div",z,[t[8]||(t[8]=(0,i.Lk)("span",null,"Organization Name",-1)),(0,i.Lk)("b",null,(0,s.v_)(U.orgData.name||U.orgData.organization_name||O.leadData.organization),1)]),(0,i.Lk)("div",v,[t[9]||(t[9]=(0,i.Lk)("span",null,"Organization Size",-1)),(0,i.Lk)("b",null,(0,s.v_)(U.orgData.size||U.orgData.organization_size||O.leadData.size),1)]),(0,i.Lk)("div",f,[t[10]||(t[10]=(0,i.Lk)("span",null,"Contract Start",-1)),(0,i.Lk)("b",null,(0,s.v_)(O.formatContractDate(U.orgData?.contract_start||U.orgData?.contract_start_date||O.leadData.contract_start)||"N/A"),1)]),(0,i.Lk)("div",$,[t[11]||(t[11]=(0,i.Lk)("span",null,"Contract End",-1)),(0,i.Lk)("b",null,(0,s.v_)(O.formatContractDate(U.orgData?.contract_end||U.orgData?.contract_end_date||O.leadData.contract_end)||"N/A"),1)]),(0,i.Lk)("div",N,[t[12]||(t[12]=(0,i.Lk)("span",null,"Address",-1)),(0,i.Lk)("b",null,[U.orgData&&(U.orgData.address||U.orgData.city||U.orgData.state||U.orgData.zip||U.orgData.country)||O.addressDisplay.length?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[(0,i.eW)((0,s.v_)(U.orgData&&(U.orgData.address||U.orgData.city||U.orgData.state||U.orgData.zip||U.orgData.country)?[U.orgData.address,U.orgData.city,U.orgData.state,U.orgData.zip,U.orgData.country].filter(Boolean).join(", "):O.addressDisplay.join(", ")),1)],64)):((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[(0,i.eW)("N/A")],64))])])],64)):((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[(0,i.Lk)("div",w,[t[13]||(t[13]=(0,i.Lk)("span",null,"Organization Name",-1)),(0,i.Lk)("b",null,(0,s.v_)(O.leadData.organization),1)]),(0,i.Lk)("div",C,[t[14]||(t[14]=(0,i.Lk)("span",null,"Organization Size",-1)),(0,i.Lk)("b",null,(0,s.v_)(O.leadData.size),1)]),(0,i.Lk)("div",E,[t[15]||(t[15]=(0,i.Lk)("span",null,"Contract Start",-1)),(0,i.Lk)("b",null,(0,s.v_)(O.formatContractDate(O.leadData.contract_start)||"N/A"),1)]),(0,i.Lk)("div",q,[t[16]||(t[16]=(0,i.Lk)("span",null,"Contract End",-1)),(0,i.Lk)("b",null,(0,s.v_)(O.formatContractDate(O.leadData.contract_end)||"N/A"),1)]),(0,i.Lk)("div",A,[t[17]||(t[17]=(0,i.Lk)("span",null,"Address",-1)),(0,i.Lk)("b",null,[O.addressDisplay.length?((0,i.uX)(),(0,i.CE)(i.FK,{key:0},[(0,i.eW)((0,s.v_)(O.addressDisplay.join(", ")),1)],64)):((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[(0,i.eW)("N/A")],64))])])],64))])])])])])])])]),_:1})}var U=e(4631),O=e(4335);const S={name:"LeadDetail",components:{MainLayout:U.A},props:{lead:{type:Object,default:()=>({contact:"",email:"",phone:"",source:"",sales_person:"",sales_person_id:null,status:"",organization:"",size:"",address:"",city:"",state:"",zip:"",country:"",country_id:null,state_id:null,city_id:null})}},data(){return{localLead:{...this.lead},countryName:"",stateName:"",cityName:"",orgData:null,orgUser:null,orgUserDetails:null,isOrganizationCreated:!1,organizationChecked:!1}},computed:{leadData(){return this.localLead},addressDisplay(){const a=[];return this.leadData.address&&a.push(this.leadData.address),this.cityName&&a.push(this.cityName),this.stateName&&a.push(this.stateName),this.leadData.zip&&a.push(this.leadData.zip),this.countryName&&a.push(this.countryName),a.filter(a=>a&&String(a).trim().length>0)},primaryUserDisplay(){if(this.orgUser&&(this.orgUser.name||this.orgUser.full_name))return this.orgUser.name||this.orgUser.full_name;if(this.orgUserDetails&&(this.orgUserDetails.first_name||this.orgUserDetails.last_name)){const a=this.orgUserDetails.first_name||"",t=this.orgUserDetails.last_name||"",e=(a+" "+t).trim();if(e)return e}return this.leadData&&this.leadData.contact?this.leadData.contact:"N/A"}},methods:{goToEditLead(){const a=this.$route.params.id||this.$route.query.id||this.leadData.id||"";a&&this.$router.push({name:"EditLead",params:{id:a}})},formatContractDate(a){if(!a)return null;const t=new Date(a);if(isNaN(t.getTime()))return null;const e=String(t.getDate()).padStart(2,"0"),i=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],s=i[t.getMonth()],r=t.getFullYear();return`${e} ${s} ,${r}`},async lookupLocationNames(){const a="http://127.0.0.1:8000";if(this.leadData.country_id)try{const t=await O.A.get(`${a}/api/countries/${this.leadData.country_id}`);this.countryName=t.data?.name||""}catch(t){console.error("Error fetching country name:",t),this.countryName=""}else this.countryName=this.leadData.country||"";if(this.leadData.state_id)try{const t=await O.A.get(`${a}/api/states/${this.leadData.state_id}`);this.stateName=t.data?.name||""}catch(t){console.error("Error fetching state name:",t),this.stateName=""}else this.stateName=this.leadData.state||"";if(this.leadData.city_id)try{const t=await O.A.get(`${a}/api/cities/${this.leadData.city_id}`);this.cityName=t.data?.name||""}catch(t){console.error("Error fetching city name:",t),this.cityName=""}else this.cityName=this.leadData.city||""},async fetchOrganizationIfExists(){this.organizationChecked=!1,this.orgData=null,this.orgUser=null,this.orgUserDetails=null,this.isOrganizationCreated=!1;const a=this.localLead.organization_id||this.localLead.org_id||this.localLead.organizationId||null,t=this.localLead.user_id||this.localLead.userId||this.localLead.owner_id||null;if(!a)return this.isOrganizationCreated=!1,void(this.organizationChecked=!0);try{const s="http://127.0.0.1:8000",r=e(3193)["default"],l=r.get("authToken"),o=l?{Authorization:`Bearer ${l}`}:{},n=await O.A.get(`${s}/api/organizations/${a}`,{headers:o});if(this.orgData=n.data||null,this.isOrganizationCreated=!!this.orgData,t){try{const a=await O.A.get(`${s}/api/users/${t}`,{headers:o});this.orgUser=a.data||null}catch(i){console.error("Error fetching organization user:",i),this.orgUser=null}try{const a=await O.A.get(`${s}/api/user-details/${t}`,{headers:o});this.orgUserDetails=a.data||null}catch(i){console.error("Error fetching organization user details:",i),this.orgUserDetails=null}}}catch(i){console.error("Error fetching organization:",i),this.orgData=null,this.isOrganizationCreated=!1}finally{this.organizationChecked=!0}}},async created(){const a=this.$route.params.id||this.$route.query.id||this.lead.id;if(a)try{const i="http://127.0.0.1:8000",s=e(3193)["default"],r=s.get("authToken"),l=await O.A.get(`${i}/api/leads/${a}`,{headers:{Authorization:`Bearer ${r}`}}),o=l.data||null;if(o){const e=o.lead?o.lead:o;this.localLead={contact:(e.first_name||"")+(e.last_name?" "+e.last_name:""),email:e.email||"",phone:e.phone||"",source:e.find_us||"",sales_person:e.sales_person||"",sales_person_id:e.sales_person_id||null,status:e.status||"",organization:e.organization_name||"",size:e.organization_size||"",address:void 0!==e.address?e.address:"",city:void 0!==e.city?e.city:"",state:void 0!==e.state?e.state:"",zip:void 0!==e.zip?e.zip:"",country:void 0!==e.country?e.country:"",country_id:e.country_id||null,state_id:e.state_id||null,city_id:e.city_id||null,id:e.id||null,first_name:e.first_name||"",last_name:e.last_name||""},o.organization&&(this.orgData=o.organization,this.orgUser=o.orgUser||null,this.orgUserDetails=o.orgUserDetails||null,this.isOrganizationCreated=!0,this.organizationChecked=!0),["address","city","state","zip","country"].forEach(a=>{void 0===this.localLead[a]&&(this.localLead[a]="")}),await this.lookupLocationNames(),this.isOrganizationCreated||await this.fetchOrganizationIfExists();try{this.$route&&this.$route.query&&Object.keys(this.$route.query).length&&this.$router.replace({name:"LeadDetail",params:{id:a}})}catch(t){console.warn("Failed to replace route",t)}return}}catch(t){return console.error("Error fetching lead details",t),this.localLead={...this.lead},await this.lookupLocationNames(),void await this.fetchOrganizationIfExists()}this.$route&&this.$route.query&&Object.keys(this.$route.query).length&&(this.localLead={contact:this.$route.query.contact||"",email:this.$route.query.email||"",phone:this.$route.query.phone||"",source:this.$route.query.source||"",sales_person:this.$route.query.sales_person||"",sales_person_id:this.$route.query.sales_person_id||null,status:this.$route.query.status||"",organization:this.$route.query.organization||"",size:this.$route.query.size||"",address:void 0!==this.$route.query.address?this.$route.query.address:"",city:void 0!==this.$route.query.city?this.$route.query.city:"",state:void 0!==this.$route.query.state?this.$route.query.state:"",zip:void 0!==this.$route.query.zip?this.$route.query.zip:"",country:void 0!==this.$route.query.country?this.$route.query.country:"",country_id:this.$route.query.country_id||null,state_id:this.$route.query.state_id||null,city_id:this.$route.query.city_id||null},["address","city","state","zip","country"].forEach(a=>{void 0===this.localLead[a]&&(this.localLead[a]="")}),await this.lookupLocationNames(),await this.fetchOrganizationIfExists())},watch:{"$route.query":{handler(a){a&&Object.keys(a).length&&(this.localLead={contact:a.contact||"",email:a.email||"",phone:a.phone||"",source:a.source||"",sales_person:a.sales_person||"",sales_person_id:a.sales_person_id||null,status:a.status||"",organization:a.organization||"",size:a.size||"",address:void 0!==a.address?a.address:"",city:void 0!==a.city?a.city:"",state:void 0!==a.state?a.state:"",zip:void 0!==a.zip?a.zip:"",country:void 0!==a.country?a.country:"",country_id:a.country_id||null,state_id:a.state_id||null,city_id:a.city_id||null},["address","city","state","zip","country"].forEach(a=>{void 0===this.localLead[a]&&(this.localLead[a]="")}),this.lookupLocationNames(),this.fetchOrganizationIfExists())},deep:!0},lead:{handler(a){this.localLead={...a},this.lookupLocationNames(),this.fetchOrganizationIfExists()},deep:!0}}};var F=e(6262);const I=(0,F.A)(S,[["render",b],["__scopeId","data-v-4e282d6c"]]),x=I}}]);
//# sourceMappingURL=411.3d8006ba.js.map