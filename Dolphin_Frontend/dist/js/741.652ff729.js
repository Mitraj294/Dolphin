"use strict";(self["webpackChunkdolphin"]=self["webpackChunkdolphin"]||[]).push([[741],{733:(e,a,t)=>{t.d(a,{A:()=>y});var o=t(641),n=t(33),s=t(8634);const l=t.p+"img/VectorLeft.078c6ba0.svg",i=t.p+"img/VectorRight.c1a1a195.svg",d={class:"footer-box"},r={class:"footer-controls split-footer-controls"},u={class:"notifications-page-size-dropdown"},c={key:0,class:"notifications-page-size-menu",ref:"pageSizeMenu"},p=["onClick"],g={class:"notifications-pagination"},m=["disabled"],v=["onClick"],h=["disabled"];function k(e,a,t,k,b,f){return(0,o.uX)(),(0,o.CE)("footer",d,[(0,o.Lk)("div",r,[(0,o.Lk)("div",u,[(0,o.Lk)("button",{class:"notifications-page-size-btn",onClick:a[0]||(a[0]=a=>e.$emit("togglePageDropdown")),ref:"pageSizeBtn"},[(0,o.eW)((0,n.v_)(t.pageSize)+"/page ",1),a[3]||(a[3]=(0,o.Lk)("img",{src:s,class:"notifications-page-size-arrow",alt:"Dropdown"},null,-1))],512),t.showPageDropdown?((0,o.uX)(),(0,o.CE)("div",c,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.pageSizes,a=>((0,o.uX)(),(0,o.CE)("div",{key:a,class:(0,n.C4)(["notifications-page-size-option",{selected:t.pageSize===a}]),onClick:t=>e.$emit("selectPageSize",a)},(0,n.v_)(a)+"/page ",11,p))),128))],512)):(0,o.Q3)("",!0)]),(0,o.Lk)("div",g,[(0,o.Lk)("button",{class:"notifications-pagination-btn prev",disabled:1===t.currentPage,onClick:a[1]||(a[1]=a=>e.$emit("goToPage",t.currentPage-1))},[...a[4]||(a[4]=[(0,o.Lk)("img",{src:l,alt:"Previous",class:"pagination-btn-icon"},null,-1),(0,o.Lk)("span",{class:"pagination-btn-text prev-text"},"Previous",-1)])],8,m),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(f.computedPaginationPages,a=>((0,o.uX)(),(0,o.CE)(o.FK,null,["..."!==a?((0,o.uX)(),(0,o.CE)("button",{key:a+"-page",class:(0,n.C4)(["notifications-pagination-page",{selected:a===t.currentPage}]),onClick:t=>e.$emit("goToPage",a)},(0,n.v_)(a),11,v)):((0,o.uX)(),(0,o.CE)("span",{key:"ellipsis-"+Math.random(),class:"notifications-pagination-page"},"..."))],64))),256)),(0,o.Lk)("button",{class:"notifications-pagination-btn next",disabled:t.currentPage===t.totalPages,onClick:a[2]||(a[2]=a=>e.$emit("goToPage",t.currentPage+1))},[...a[5]||(a[5]=[(0,o.Lk)("span",{class:"pagination-btn-text next-text"},"Next",-1),(0,o.Lk)("img",{src:i,alt:"Next",class:"pagination-btn-icon"},null,-1)])],8,h)])])])}const b={name:"Pagination",props:{withPagination:{type:Boolean,default:!1},pageSize:Number,pageSizes:Array,showPageDropdown:Boolean,currentPage:Number,totalPages:{type:Number,default:10},paginationPages:Array},computed:{computedPaginationPages(){const e=this.totalPages||10,a=this.currentPage||1;return e<=7?Array.from({length:e},(e,a)=>a+1):a<=3?[1,2,3,4,"...",e-1,e]:4===a?[1,3,4,5,"...",e-1,e]:5===a?[1,4,5,6,"...",e-1,e]:6===a?[1,5,6,7,"...",e-1,e]:7===a?[1,2,"...",6,7,8,e,e-1].filter((e,a,t)=>t.indexOf(e)===a):a===e-2?[1,2,"...",e-3,e-2,e-1,e]:a===e-1||a===e?[1,2,"...",e-2,e-1,e]:[1,2,"...",a-1,a,a+1,"...",e-1,e].filter((e,a,t)=>t.indexOf(e)===a)}},mounted(){document.addEventListener("mousedown",this.handleClickOutside)},beforeUnmount(){document.removeEventListener("mousedown",this.handleClickOutside)},methods:{handleClickOutside(e){if(!this.showPageDropdown)return;const a=this.$refs.pageSizeMenu,t=this.$refs.pageSizeBtn;a&&!a.contains(e.target)&&t&&!t.contains(e.target)&&this.$emit("togglePageDropdown")}}};var f=t(6262);const L=(0,f.A)(b,[["render",k],["__scopeId","data-v-63376d46"]]),y=L},1235:(e,a,t)=>{t.r(a),t.d(a,{default:()=>G});var o=t(641),n=t(3751),s=t(33),l=t(1728),i=t(6664);const d=t.p+"img/AddBlack.309c9cd0.svg",r=t.p+"img/Actions.51599183.svg",u={class:"page"},c={class:"table-outer"},p={class:"table-card"},g={class:"table-search-header-row"},m={class:"table-search-bar-filters"},v={class:"table-search-bar-filters"},h={class:"table-container"},k={class:"table-scroll"},b={class:"table"},f={"data-label":"Contact"},L=["onClick"],y={"data-label":"Email"},w={"data-label":"Phone Number"},C={"data-label":"Organization"},P={"data-label":"Size"},S={"data-label":"Source"},z={"data-label":"Status"},A={"data-label":"Notes"},_=["onClick"],E={"data-label":"Actions",style:{position:"relative"}},x={class:"actions-row"},K=["onClick","aria-expanded"],D=["onClick"],M={class:"notes-modal"},N={class:"notes-modal-actions"};function X(e,a,t,X,$,T){const F=(0,o.g2)("Toast"),W=(0,o.g2)("FormDropdown"),O=(0,o.g2)("TableHeader"),R=(0,o.g2)("Pagination"),V=(0,o.g2)("MainLayout");return(0,o.uX)(),(0,o.Wv)(V,null,{default:(0,o.k6)(()=>[(0,o.Lk)("div",u,[(0,o.bF)(F),(0,o.Lk)("div",c,[(0,o.Lk)("div",p,[(0,o.Lk)("div",g,[(0,o.Lk)("div",m,[(0,o.bo)((0,o.Lk)("input",{class:"org-search",placeholder:"Search Leads ....","onUpdate:modelValue":a[0]||(a[0]=e=>X.search=e)},null,512),[[n.Jo,X.search]]),(0,o.Lk)("div",v,[(0,o.bF)(W,{modelValue:X.form.organization_size,"onUpdate:modelValue":a[1]||(a[1]=e=>X.form.organization_size=e),icon:"fas fa-users",options:[{value:null,text:"Select",disabled:!0},...X.orgSizeOptions.map(e=>({value:e,text:e}))],required:""},null,8,["modelValue","options"]),(0,o.bF)(W,{modelValue:X.form.find_us,"onUpdate:modelValue":a[2]||(a[2]=e=>X.form.find_us=e),icon:"fas fa-search",options:[{value:null,text:"Select",disabled:!0},...X.findUsOptions.map(e=>({value:e,text:e}))],required:""},null,8,["modelValue","options"])])]),(0,o.Lk)("button",{class:"btn btn-primary add-new-btn",onClick:a[3]||(a[3]=a=>e.$router.push("/leads/lead-capture"))},[...a[10]||(a[10]=[(0,o.Lk)("img",{src:l,alt:"Add",class:"leads-add-btn-icon"},null,-1),(0,o.eW)(" Add New ",-1)])])]),(0,o.Lk)("div",h,[(0,o.Lk)("div",k,[(0,o.Lk)("table",b,[(0,o.bF)(O,{columns:X.tableColumns,onSort:X.sortBy},null,8,["columns","onSort"]),(0,o.Lk)("tbody",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(X.paginatedLeads,(e,t)=>((0,o.uX)(),(0,o.CE)("tr",{key:e.id||e.email},[(0,o.Lk)("td",f,[(0,o.Lk)("span",{class:"lead-contact-link",onClick:a=>X.goToLeadDetail(e)},(0,s.v_)(e.contact),9,L)]),(0,o.Lk)("td",y,(0,s.v_)(e.email),1),(0,o.Lk)("td",w,(0,s.v_)(e.phone),1),(0,o.Lk)("td",C,(0,s.v_)(e.organization),1),(0,o.Lk)("td",P,(0,s.v_)(e.size),1),(0,o.Lk)("td",S,(0,s.v_)(e.source),1),(0,o.Lk)("td",z,[(0,o.Lk)("span",{class:(0,s.C4)(["status-badge",e.status&&e.status.toLowerCase().replace(/\s+/g,"-")])},(0,s.v_)(e.status||"Lead Stage"),3)]),(0,o.Lk)("td",A,[(0,o.Lk)("button",{class:"btn-view",onClick:a=>X.openNotesModal(e)},["View"===e.notesAction?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[a[11]||(a[11]=(0,o.Lk)("img",{src:i,alt:"View",class:"btn-view-icon"},null,-1)),a[12]||(a[12]=(0,o.eW)(" View ",-1))],64)):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[a[13]||(a[13]=(0,o.Lk)("img",{src:d,alt:"Add",class:"btn-view-icon"},null,-1)),a[14]||(a[14]=(0,o.eW)(" Add ",-1))],64))],8,_)]),(0,o.Lk)("td",E,[(0,o.Lk)("div",x,[(0,o.Lk)("button",{class:"leads-menu-btn",onClick:(0,n.D$)(a=>X.toggleMenu(e.id||t),["stop"]),"aria-haspopup":"true","aria-expanded":X.menuOpen===(e.id||t)},[...a[15]||(a[15]=[(0,o.Lk)("img",{src:r,alt:"Actions",width:"20",height:"20",class:"leads-menu-icon"},null,-1)])],8,K),X.menuOpen===(e.id||t)?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"leads-menu custom-leads-menu",ref_for:!0,ref:"menuDropdown",onClick:a[4]||(a[4]=(0,n.D$)(()=>{},["stop"]))},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(X.customMenuOptions,a=>((0,o.uX)(),(0,o.CE)("div",{class:"leads-menu-item",key:a,onClick:t=>X.selectCustomAction(e,a)},(0,s.v_)(a),9,D))),128))],512)):(0,o.Q3)("",!0)])])]))),128))])])])])]),(0,o.bF)(R,{pageSize:X.pageSize,pageSizes:[10,25,100],showPageDropdown:X.showPageDropdown,currentPage:X.currentPage,totalPages:X.totalPages,paginationPages:X.paginationPages,onGoToPage:X.goToPage,onSelectPageSize:X.selectPageSize,onTogglePageDropdown:a[5]||(a[5]=e=>X.showPageDropdown=!X.showPageDropdown)},null,8,["pageSize","showPageDropdown","currentPage","totalPages","paginationPages","onGoToPage","onSelectPageSize"]),X.showNotesModal?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"notes-modal-overlay",onClick:a[9]||(a[9]=(0,n.D$)((...e)=>X.closeNotesModal&&X.closeNotesModal(...e),["self"]))},[(0,o.Lk)("div",M,[(0,o.Lk)("h3",null,(0,s.v_)("add"===X.notesModalMode?"Add Notes":"Notes"),1),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":a[6]||(a[6]=e=>X.notesInput=e),rows:"5",placeholder:"Enter notes here...",class:"notes-textarea"},null,512),[[n.Jo,X.notesInput]]),(0,o.Lk)("div",N,[(0,o.Lk)("button",{class:"btn btn-primary",onClick:a[7]||(a[7]=(...e)=>X.updateLeadNotes&&X.updateLeadNotes(...e))},(0,s.v_)("add"===X.notesModalMode?"Submit":"Update"),1),(0,o.Lk)("button",{class:"btn btn-secondary",onClick:a[8]||(a[8]=(...e)=>X.closeNotesModal&&X.closeNotesModal(...e))}," Cancel ")])])])):(0,o.Q3)("",!0)])])]),_:1})}var $=t(953),T=t(5220),F=t(4335),W=t(3080),O=t(7035),R=t(4631),V=t(733),I=t(5629),B=t(3413),U=t(3270),q=t(3193);const Q={name:"Leads",components:{MainLayout:R.A,Pagination:V.A,TableHeader:I.A,Toast:B.A,FormDropdown:O.A},setup(){const e=(0,T.rd)(),a=(0,W.d)(),t=(0,$.KR)([]),n=(0,$.KR)(null),s=(0,$.KR)(10),l=(0,$.KR)(1),i=(0,$.KR)(!1),d=(0,$.KR)(!1),r=(0,$.KR)("add"),u=(0,$.KR)(""),c=(0,$.KR)(null),p=(0,$.KR)(""),g=(0,$.KR)(!0),m=(0,$.KR)(!1),v=(0,$.KR)(""),h=["Schedule Demo","Schedule Class/Training","Send Assessment"],k=[{label:"Contact",key:"contact",sortable:!0,width:"170px"},{label:"Email",key:"email",width:"250px"},{label:"Phone Number",key:"phone",width:"150px"},{label:"Organization",key:"organization",sortable:!0,width:"150px"},{label:"Size",width:"100px"},{label:"Source",width:"120px"},{label:"Status",key:"status",sortable:!0,width:"150px"},{label:"Notes",key:"notesAction",width:"100px"},{label:"Actions",key:"actions",width:"80px"}],b=(0,$.KR)({organization_size:null,find_us:null}),f=(0,o.EW)(()=>{let e=t.value;if(v.value){const a=v.value.toLowerCase();e=e.filter(e=>e.contact.toLowerCase().includes(a)||e.email.toLowerCase().includes(a)||e.organization.toLowerCase().includes(a))}return b.value.organization_size&&(e=e.filter(e=>e.size===b.value.organization_size)),b.value.find_us&&(e=e.filter(e=>e.source===b.value.find_us)),e}),L={"Lead Stage":1,"Assessment Sent":2,Registered:3},y=(0,o.EW)(()=>p.value?[...f.value].sort((e,a)=>{let t=0;if("status"===p.value){const o=L[e.status||"Lead Stage"]||0,n=L[a.status||"Lead Stage"]||0;t=o-n}else{const o=e[p.value],n=a[p.value];o<n&&(t=-1),o>n&&(t=1)}return g.value?t:-t}):f.value),w=(0,o.EW)(()=>Math.ceil(y.value.length/s.value)),C=(0,o.EW)(()=>{const e=(l.value-1)*s.value,a=e+s.value;return y.value.slice(e,a)}),P=(0,o.EW)(()=>{const e=[];for(let a=1;a<=w.value;a++)e.push(a);return e}),S=async()=>{m.value=!0;try{const a=q["default"].get("authToken");if(!a)return void e.push("/login");const o="http://127.0.0.1:8000",n=await F.A.get(`${o}/api/leads`,{headers:{Authorization:`Bearer ${a}`}});t.value=n.data.map(e=>({id:e.id,contact:`${e.first_name} ${e.last_name}`,email:e.email,phone:e.phone,organization:e.organization_name,size:e.organization_size,source:e.find_us,status:e.status,notes:e.notes,notesAction:e.notes?"View":"Add"}))}catch(o){console.error("Failed to fetch leads:",o),a.add({severity:"error",summary:"Error",detail:"Failed to fetch leads.",life:3e3})}finally{m.value=!1}},z=e=>{p.value===e?g.value=!g.value:(p.value=e,g.value=!0)},A=e=>{e>=1&&e<=w.value&&(l.value=e)},_=e=>{s.value=e,l.value=1,i.value=!1},E=e=>{n.value=n.value===e?null:e},x=e=>{n.value&&!e.target.closest(".actions-row")&&(n.value=null)},K=e=>{c.value=e,u.value=e.notes||"",r.value=e.notes?"view":"add",d.value=!0},D=()=>{d.value=!1,c.value=null,u.value=""},M=async()=>{if(c.value)try{const e=q["default"].get("authToken"),o="http://127.0.0.1:8000";await F.A.patch(`${o}/api/leads/${c.value.id}`,{notes:u.value},{headers:{Authorization:`Bearer ${e}`}}),a.add({severity:"success",summary:"Success",detail:"Notes updated successfully.",life:3e3});const n=t.value.find(e=>e.id===c.value.id);n&&(n.notes=u.value,n.notesAction=u.value?"View":"Add"),D()}catch(e){console.error("Failed to update notes:",e),a.add({severity:"error",summary:"Error",detail:"Failed to update notes.",life:3e3})}},N=a=>{e.push({name:"LeadDetail",params:{id:a.id}})},X=(t,o)=>{console.log(`Action "${o}" selected for lead:`,t.contact),n.value=null,"Schedule Demo"===o?e.push({name:"ScheduleDemo",query:{lead_id:t.id}}):"Schedule Class/Training"===o?e.push({name:"ScheduleClassTraining",query:{lead_id:t.id}}):"Send Assessment"===o?e.push({name:"SendAssessment",params:{id:t.id}}):a.add({severity:"info",summary:"Info",detail:`Action "${o}" is not implemented yet.`,life:3e3})};return(0,o.sV)(()=>{S(),document.addEventListener("click",x)}),(0,o.xo)(()=>{document.removeEventListener("click",x)}),{leads:t,menuOpen:n,pageSize:s,currentPage:l,showPageDropdown:i,showNotesModal:d,notesModalMode:r,notesInput:u,currentLead:c,sortKey:p,sortAsc:g,isLoading:m,customMenuOptions:h,tableColumns:k,paginatedLeads:C,totalPages:w,paginationPages:P,sortBy:z,goToPage:A,selectPageSize:_,toggleMenu:E,openNotesModal:K,closeNotesModal:D,updateLeadNotes:M,goToLeadDetail:N,selectCustomAction:X,findUsOptions:U.ch,orgSizeOptions:U.w6,form:b,search:v}}};var H=t(6262);const j=(0,H.A)(Q,[["render",X],["__scopeId","data-v-18b5e765"]]),G=j},1728:(e,a,t)=>{e.exports=t.p+"img/Add.1f261cbb.svg"},5629:(e,a,t)=>{t.d(a,{A:()=>p});var o=t(641),n=t(33),s=t(3751);const l=t.p+"img/up-down.53d62c9d.svg",i=["role","tabindex","onClick","onKeyup"];function d(e,a,t,d,r,u){return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.Lk)("colgroup",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.columns,(e,a)=>((0,o.uX)(),(0,o.CE)("col",{key:"col-"+(e.key||a),class:(0,n.C4)(e.width||e.minWidth),style:(0,n.Tr)(u.getColumnStyle(e))},null,6))),128))]),(0,o.Lk)("thead",null,[(0,o.Lk)("tr",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.columns,(a,d)=>((0,o.uX)(),(0,o.CE)("th",{key:a.key||d,class:(0,n.C4)([0===d?"rounded-th-left":"",d===t.columns.length-1?"rounded-th-right":"",a.width||a.minWidth,a.class||""]),style:(0,n.Tr)(u.getColumnStyle(a)),role:a.sortable?"button":null,tabindex:a.sortable?0:null,scope:"col",onClick:t=>!0===a.sortable?e.$emit("sort",a.key):null,onKeyup:(0,s.jR)(t=>!0===a.sortable?e.$emit("sort",a.key):null,["enter"])},[(0,o.Lk)("span",{class:(0,n.C4)(["org-th-content",a.sortable?"org-th-sortable":"",t.activeSortKey===a.key?"sorted":""])},[(0,o.eW)((0,n.v_)(a.label)+" ",1),!0===a.sortable?((0,o.uX)(),(0,o.CE)("img",{key:0,src:l,class:(0,n.C4)(["org-th-sort",t.activeSortKey===a.key?t.sortAsc?"asc":"desc":""]),alt:"Sort"},null,2)):(0,o.Q3)("",!0)],2)],46,i))),128))])])],64)}const r={name:"TableHeader",emits:["sort"],props:{columns:{type:Array,required:!0},activeSortKey:{type:String,default:null},sortAsc:{type:Boolean,default:!0}},methods:{getColumnStyle(e){let a={};if(e.width&&(a.width="number"===typeof e.width?e.width+"px":e.width),e.minWidth&&(a.minWidth="number"===typeof e.minWidth?e.minWidth+"px":e.minWidth),e.style){const t=e.style.split(";").filter(e=>e.trim());t.forEach(e=>{const[t,o]=e.split(":").map(e=>e.trim());if(t&&o){const e=t.replace(/-([a-z])/g,e=>e[1].toUpperCase());a[e]=o}})}return Object.keys(a).length>0?a:null}}};var u=t(6262);const c=(0,u.A)(r,[["render",d],["__scopeId","data-v-9953bdcc"]]),p=c},6664:(e,a,t)=>{e.exports=t.p+"img/Detail.a366cc56.svg"}}]);
//# sourceMappingURL=741.652ff729.js.map