"use strict";(self["webpackChunkdolphin"]=self["webpackChunkdolphin"]||[]).push([[926],{733:(t,e,a)=>{a.d(e,{A:()=>w});var n=a(641),o=a(33),i=a(8634);const s=a.p+"img/VectorLeft.078c6ba0.svg",r=a.p+"img/VectorRight.c1a1a195.svg",l={class:"footer-box"},c={class:"footer-controls split-footer-controls"},g={class:"notifications-page-size-dropdown"},d={key:0,class:"notifications-page-size-menu",ref:"pageSizeMenu"},u=["onClick"],p={class:"notifications-pagination"},h=["disabled"],m=["onClick"],y=["disabled"];function b(t,e,a,b,f,k){return(0,n.uX)(),(0,n.CE)("footer",l,[(0,n.Lk)("div",c,[(0,n.Lk)("div",g,[(0,n.Lk)("button",{class:"notifications-page-size-btn",onClick:e[0]||(e[0]=e=>t.$emit("togglePageDropdown")),ref:"pageSizeBtn"},[(0,n.eW)((0,o.v_)(a.pageSize)+"/page ",1),e[3]||(e[3]=(0,n.Lk)("img",{src:i,class:"notifications-page-size-arrow",alt:"Dropdown"},null,-1))],512),a.showPageDropdown?((0,n.uX)(),(0,n.CE)("div",d,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.pageSizes,e=>((0,n.uX)(),(0,n.CE)("div",{key:e,class:(0,o.C4)(["notifications-page-size-option",{selected:a.pageSize===e}]),onClick:a=>t.$emit("selectPageSize",e)},(0,o.v_)(e)+"/page ",11,u))),128))],512)):(0,n.Q3)("",!0)]),(0,n.Lk)("div",p,[(0,n.Lk)("button",{class:"notifications-pagination-btn prev",disabled:1===a.currentPage,onClick:e[1]||(e[1]=e=>t.$emit("goToPage",a.currentPage-1))},[...e[4]||(e[4]=[(0,n.Lk)("img",{src:s,alt:"Previous",class:"pagination-btn-icon"},null,-1),(0,n.Lk)("span",{class:"pagination-btn-text prev-text"},"Previous",-1)])],8,h),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(k.computedPaginationPages,e=>((0,n.uX)(),(0,n.CE)(n.FK,null,["..."!==e?((0,n.uX)(),(0,n.CE)("button",{key:e+"-page",class:(0,o.C4)(["notifications-pagination-page",{selected:e===a.currentPage}]),onClick:a=>t.$emit("goToPage",e)},(0,o.v_)(e),11,m)):((0,n.uX)(),(0,n.CE)("span",{key:"ellipsis-"+Math.random(),class:"notifications-pagination-page"},"..."))],64))),256)),(0,n.Lk)("button",{class:"notifications-pagination-btn next",disabled:a.currentPage===a.totalPages,onClick:e[2]||(e[2]=e=>t.$emit("goToPage",a.currentPage+1))},[...e[5]||(e[5]=[(0,n.Lk)("span",{class:"pagination-btn-text next-text"},"Next",-1),(0,n.Lk)("img",{src:r,alt:"Next",class:"pagination-btn-icon"},null,-1)])],8,y)])])])}const f={name:"Pagination",props:{withPagination:{type:Boolean,default:!1},pageSize:Number,pageSizes:Array,showPageDropdown:Boolean,currentPage:Number,totalPages:{type:Number,default:10},paginationPages:Array},computed:{computedPaginationPages(){const t=this.totalPages||10,e=this.currentPage||1;return t<=7?Array.from({length:t},(t,e)=>e+1):e<=3?[1,2,3,4,"...",t-1,t]:4===e?[1,3,4,5,"...",t-1,t]:5===e?[1,4,5,6,"...",t-1,t]:6===e?[1,5,6,7,"...",t-1,t]:7===e?[1,2,"...",6,7,8,t,t-1].filter((t,e,a)=>a.indexOf(t)===e):e===t-2?[1,2,"...",t-3,t-2,t-1,t]:e===t-1||e===t?[1,2,"...",t-2,t-1,t]:[1,2,"...",e-1,e,e+1,"...",t-1,t].filter((t,e,a)=>a.indexOf(t)===e)}},mounted(){document.addEventListener("mousedown",this.handleClickOutside)},beforeUnmount(){document.removeEventListener("mousedown",this.handleClickOutside)},methods:{handleClickOutside(t){if(!this.showPageDropdown)return;const e=this.$refs.pageSizeMenu,a=this.$refs.pageSizeBtn;e&&!e.contains(t.target)&&a&&!a.contains(t.target)&&this.$emit("togglePageDropdown")}}};var k=a(6262);const P=(0,k.A)(f,[["render",b],["__scopeId","data-v-63376d46"]]),w=P},2185:(t,e,a)=>{a.r(e),a.d(e,{default:()=>L});var n=a(641);const o={class:"page"};function i(t,e,a,i,s,r){const l=(0,n.g2)("OrganizationTable"),c=(0,n.g2)("MainLayout");return(0,n.uX)(),(0,n.Wv)(c,null,{default:(0,n.k6)(()=>[(0,n.Lk)("div",o,[(0,n.bF)(l)])]),_:1})}var s=a(4631),r=a(3751),l=a(33),c=a(6664);const g={class:"table-outer"},d={class:"table-card"},u={class:"table-search-bar"},p={class:"table-container"},h={class:"table"},m=["onClick"];function y(t,e,a,o,i,s){const y=(0,n.g2)("Toast"),b=(0,n.g2)("TableHeader"),f=(0,n.g2)("Pagination");return(0,n.uX)(),(0,n.CE)("div",g,[(0,n.bF)(y),(0,n.Lk)("div",d,[(0,n.Lk)("div",u,[(0,n.bo)((0,n.Lk)("input",{class:"org-search",placeholder:"Search Organization Name","onUpdate:modelValue":e[0]||(e[0]=t=>i.search=t)},null,512),[[r.Jo,i.search]])]),(0,n.Lk)("div",p,[(0,n.Lk)("table",h,[(0,n.bF)(b,{columns:[{label:"Organizations Name",key:"name",sortable:!0,minWidth:"200px"},{label:"Size",key:"size",minWidth:"100px"},{label:"Admin Name",key:"main_contact",minWidth:"150px"},{label:"Contract Start",key:"contractStart",sortable:!0,minWidth:"150px"},{label:"Contract End",key:"contractEnd",sortable:!0,minWidth:"150px"},{label:"Last Contacted",key:"last_contacted",sortable:!0},{label:"Action",key:"action"}],activeSortKey:i.sortKey,sortAsc:i.sortAsc,onSort:s.sortBy},null,8,["activeSortKey","sortAsc","onSort"]),(0,n.Lk)("tbody",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.paginatedOrganizations,t=>((0,n.uX)(),(0,n.CE)("tr",{key:t.id},[(0,n.Lk)("td",null,(0,l.v_)(t.name),1),(0,n.Lk)("td",null,(0,l.v_)(t.size),1),(0,n.Lk)("td",null,(0,l.v_)(t.main_contact),1),(0,n.Lk)("td",null,(0,l.v_)(s.formatDate(t.contractStart)||"-"),1),(0,n.Lk)("td",null,(0,l.v_)(s.formatDate(t.contractEnd)||"-"),1),(0,n.Lk)("td",null,(0,l.v_)(s.formatDateTime(t.last_contacted)||"-"),1),(0,n.Lk)("td",null,[(0,n.Lk)("button",{class:"btn-view",onClick:e=>s.goToDetail(t)},[...e[2]||(e[2]=[(0,n.Lk)("img",{src:c,alt:"View",class:"btn-view-icon"},null,-1),(0,n.eW)(" View Detail ",-1)])],8,m)])]))),128))])])])]),(0,n.bF)(f,{withPagination:!0,pageSize:i.pageSize,pageSizes:[10,25,100],showPageDropdown:i.showPageDropdown,currentPage:i.currentPage,totalPages:s.totalPages,paginationPages:s.paginationPages,onTogglePageDropdown:e[1]||(e[1]=t=>i.showPageDropdown=!i.showPageDropdown),onSelectPageSize:s.selectPageSize,onGoToPage:s.goToPage},null,8,["pageSize","showPageDropdown","currentPage","totalPages","paginationPages","onSelectPageSize","onGoToPage"])])}var b=a(733),f=a(5629),k=a(3413);const P={name:"OrganizationTable",components:{Pagination:b.A,TableHeader:f.A,Toast:k.A},data(){return{search:"",showPageDropdown:!1,pageSize:10,currentPage:1,sortKey:"",sortAsc:!0,organizations:[]}},computed:{filteredOrganizations(){let t=this.organizations;return this.search&&(t=t.filter(t=>t.name.toLowerCase().includes(this.search.toLowerCase()))),this.sortKey&&(t=t.slice().sort((t,e)=>{let a=t[this.sortKey],n=e[this.sortKey];if("contractStart"===this.sortKey||"contractEnd"===this.sortKey||"last_contacted"===this.sortKey){const t=new Date(a),e=new Date(n);if(!isNaN(t)&&!isNaN(e))return this.sortAsc?t-e:e-t}return a<n?this.sortAsc?-1:1:a>n?this.sortAsc?1:-1:0})),t},totalPages(){return Math.ceil(this.filteredOrganizations.length/this.pageSize)||1},paginatedOrganizations(){const t=(this.currentPage-1)*this.pageSize;return this.filteredOrganizations.slice(t,t+this.pageSize)},paginationPages(){const t=[];return t.push(1,2,3,"...",8,9,10),t}},mounted(){this.fetchOrganizations()},methods:{async fetchOrganizations(){try{const t=(await Promise.resolve().then(a.bind(a,3193))).default,e=t.get("authToken");if(!e)return this.$toast.add({severity:"warn",summary:"Authentication Required",detail:"Please log in to view organizations.",sticky:!0}),void this.$router.push({name:"Login"});const n={Authorization:`Bearer ${e}`},o=(await a.e(110).then(a.bind(a,3110))).default,i=await o.get("http://127.0.0.1:8000/api/organizations",{headers:n});this.organizations=i.data.map(t=>({name:t.organization_name,size:t.organization_size||"",main_contact:t.main_contact||"",contractStart:t.contract_start||"",contractEnd:t.contract_end||"",last_contacted:t.last_contacted||"",id:t.id}))}catch(t){if(t.response&&401===t.response.status){this&&this.$toast&&"function"===typeof this.$toast.add&&this.$toast.add({severity:"warn",summary:"Session expired",detail:"Session expired or unauthorized. Please log in again.",sticky:!0});const t=(await Promise.resolve().then(a.bind(a,3193))).default;t.clear(),this.$router.push({name:"Login"})}else"Token expired"===t.message?this&&this.$toast&&"function"===typeof this.$toast.add&&this.$toast.add({severity:"warn",summary:"Session expired",detail:"Your session has expired. Please log in again.",sticky:!0}):(console.error("Error fetching organizations:",t),this&&this.$toast&&"function"===typeof this.$toast.add&&this.$toast.add({severity:"error",summary:"Error",detail:"Failed to load organizations. Please try again.",life:5e3}));this.organizations=[]}},goToDetail(t){this.$router.push({name:"OrganizationDetail",params:{id:t.id,orgName:t.name}})},formatDate(t){if(!t)return null;const e=String(t).match(/^(\d{4})-(\d{2})-(\d{2})(?:[ T](\d{2}):(\d{2})(?::(\d{2}))?)?$/);let a;if(e){const t=parseInt(e[1],10),n=parseInt(e[2],10)-1,o=parseInt(e[3],10),i=e[4]?parseInt(e[4],10):0,s=e[5]?parseInt(e[5],10):0,r=e[6]?parseInt(e[6],10):0;a=new Date(Date.UTC(t,n,o,i,s,r))}else a=new Date(t);if(isNaN(a.getTime()))return null;const n=String(a.getDate()).padStart(2,"0"),o=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],i=o[a.getMonth()],s=a.getFullYear();return`${n} ${i},${s}`},formatDateTime(t){if(!t)return null;const e=String(t).match(/^(\d{4})-(\d{2})-(\d{2})(?:[ T](\d{2}):(\d{2})(?::(\d{2}))?)?$/);let a;if(e){const t=parseInt(e[1],10),n=parseInt(e[2],10)-1,o=parseInt(e[3],10),i=e[4]?parseInt(e[4],10):0,s=e[5]?parseInt(e[5],10):0,r=e[6]?parseInt(e[6],10):0;a=new Date(Date.UTC(t,n,o,i,s,r))}else a=new Date(t);if(isNaN(a.getTime()))return null;const n=String(a.getDate()).padStart(2,"0"),o=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],i=o[a.getMonth()],s=a.getFullYear();let r=a.getHours();const l=String(a.getMinutes()).padStart(2,"0"),c=r>=12?"PM":"AM";r%=12,r=r||12;const g=`${r}:${l} ${c}`;return`${n} ${i},${s} ${g}`},goToPage(t){"..."===t||t<1||t>this.totalPages||(this.currentPage=t)},selectPageSize(t){this.pageSize=t,this.currentPage=1,this.showPageDropdown=!1},sortBy(t){this.sortKey===t?this.sortAsc=!this.sortAsc:(this.sortKey=t,this.sortAsc=!0)}}};var w=a(6262);const z=(0,w.A)(P,[["render",y],["__scopeId","data-v-b3bb8c14"]]),v=z,S={name:"Organizations",components:{MainLayout:s.A,OrganizationTable:v}},C=(0,w.A)(S,[["render",i]]),L=C},5629:(t,e,a)=>{a.d(e,{A:()=>u});var n=a(641),o=a(33),i=a(3751);const s=a.p+"img/up-down.53d62c9d.svg",r=["role","tabindex","onClick","onKeyup"];function l(t,e,a,l,c,g){return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.Lk)("colgroup",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.columns,(t,e)=>((0,n.uX)(),(0,n.CE)("col",{key:"col-"+(t.key||e),class:(0,o.C4)(t.width||t.minWidth),style:(0,o.Tr)(g.getColumnStyle(t))},null,6))),128))]),(0,n.Lk)("thead",null,[(0,n.Lk)("tr",null,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.columns,(e,l)=>((0,n.uX)(),(0,n.CE)("th",{key:e.key||l,class:(0,o.C4)([0===l?"rounded-th-left":"",l===a.columns.length-1?"rounded-th-right":"",e.width||e.minWidth,e.class||""]),style:(0,o.Tr)(g.getColumnStyle(e)),role:e.sortable?"button":null,tabindex:e.sortable?0:null,scope:"col",onClick:a=>!0===e.sortable?t.$emit("sort",e.key):null,onKeyup:(0,i.jR)(a=>!0===e.sortable?t.$emit("sort",e.key):null,["enter"])},[(0,n.Lk)("span",{class:(0,o.C4)(["org-th-content",e.sortable?"org-th-sortable":"",a.activeSortKey===e.key?"sorted":""])},[(0,n.eW)((0,o.v_)(e.label)+" ",1),!0===e.sortable?((0,n.uX)(),(0,n.CE)("img",{key:0,src:s,class:(0,o.C4)(["org-th-sort",a.activeSortKey===e.key?a.sortAsc?"asc":"desc":""]),alt:"Sort"},null,2)):(0,n.Q3)("",!0)],2)],46,r))),128))])])],64)}const c={name:"TableHeader",emits:["sort"],props:{columns:{type:Array,required:!0},activeSortKey:{type:String,default:null},sortAsc:{type:Boolean,default:!0}},methods:{getColumnStyle(t){let e={};if(t.width&&(e.width="number"===typeof t.width?t.width+"px":t.width),t.minWidth&&(e.minWidth="number"===typeof t.minWidth?t.minWidth+"px":t.minWidth),t.style){const a=t.style.split(";").filter(t=>t.trim());a.forEach(t=>{const[a,n]=t.split(":").map(t=>t.trim());if(a&&n){const t=a.replace(/-([a-z])/g,t=>t[1].toUpperCase());e[t]=n}})}return Object.keys(e).length>0?e:null}}};var g=a(6262);const d=(0,g.A)(c,[["render",l],["__scopeId","data-v-9953bdcc"]]),u=d},6664:(t,e,a)=>{t.exports=a.p+"img/Detail.a366cc56.svg"}}]);
//# sourceMappingURL=926.e4ea5701.js.map